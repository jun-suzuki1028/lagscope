# 要求仕様書

## 概要

この文書は、「LagScope」の要求仕様を定義します。これは、大乱闘スマッシュブラザーズ SPECIALにおいて、特定の技をシールドした後の確定反撃技を算出するWebベースのツールです。このツールは、中級者から上級者のプレイヤーが、機能の拡張、複数キャラクターの比較、より優れたユーザーエクスペリエンスを備えた既存ツールの改良版として、どの反撃技が確定するかを判断するのに役立ちます。

## 要求仕様

### 要求仕様 1

**ユーザーストーリー：** 競技スマブラプレイヤーとして、攻撃側のキャラクターとその技を選択し、その技に対する反撃機会を分析したい。

#### 受け入れ基準

1. ユーザーがメインインターフェースにアクセスした時、システムは全SPECIALファイターを含むキャラクター選択ドロップダウンを表示する
2. キャラクターが選択された時、システムはそのキャラクターの技セットをカテゴリ別（通常技、必殺技、投げ技）に整理して読み込み、表示する
3. 技が選択された時、システムは発生フレーム、全体フレーム、シールド硬直差を含む技のフレームデータを表示する
4. 技に可変フレームデータがある場合、システムは可能な値の範囲を表示する

### 要求仕様 2

**ユーザーストーリー：** 対戦相手を研究しているプレイヤーとして、自分の防御側キャラクターを選択し、利用可能な反撃技を確認したい。

#### 受け入れ基準

1. ユーザーが防御側キャラクターを選択した時、システムはそのキャラクターの完全な技セットとフレームデータを読み込む
2. 複数の防御側キャラクターが選択された時、システムは選択されたすべてのキャラクターの同時比較をサポートする
3. 防御側キャラクターが選択された時、システムはそのキャラクターのガードキャンセル行動（ジャンプ、上必殺ワザ、上スマッシュ）と各行動の発生フレームを表示する
4. 防御側キャラクターが選択されていない場合、システムは計算前にユーザーに選択を促す

### 要求仕様 3

**ユーザーストーリー：** フレームデータ分析者として、システムが確定反撃技を正確に算出し、試合で情報に基づいた決定を下せるようにしたい。

#### 受け入れ基準

1. 計算が実行された時、システムは次の公式を使用する：シールド硬直差 >= 技の発生フレーム
2. 反撃技を計算する時、システムはガードキャンセル行動を考慮する：
   - ジャンプキャンセル空中攻撃: 3F（踏み切り） + 各空中攻撃の発生フレーム
   - 上必殺ワザ: キャラクター固有の発生フレーム
   - 上スマッシュ: キャラクター固有の発生フレーム
3. 反撃技を計算する時、システムは地上技に対する通常のシールド解除（11F）を考慮する
4. 技にワンパターン相殺が適用されている場合、システムは直近9回の攻撃履歴に基づいてダメージ減衰を計算し、シールド硬直差を調整する
5. 反撃技が存在する場合、システムはフレーム有利ウィンドウを計算して表示する

### 要求仕様 4

**ユーザーストーリー：** 大会プレイヤーとして、反撃結果を整理・フィルタリングして表示し、最も実用的な選択肢を素早く特定したい。

#### 受け入れ基準

1. 結果が表示された時、システムは反撃技を発生フレーム順（最速優先）でソートする
2. 結果が表示された時、システムは技を種類別（通常技、必殺技、投げ技）にカテゴリ分けする
3. 結果に撃墜技が含まれる場合、システムはこれらの技を視覚的にハイライト表示する
4. 距離フィルタリングが有効な場合、システムは技のリーチとシールドノックバックを考慮して、実際に届く反撃技のみを表示する
5. 確定反撃技が存在しない場合、システムはこれをユーザーに明確に示す

### 要求仕様 5

**ユーザーストーリー：** コンテンツクリエイターとして、計算結果をエクスポートし、コミュニティと発見を共有したい。

#### 受け入れ基準

1. ユーザーがデータエクスポートを要求した時、システムはCSV形式でのダウンロードを提供する
2. ユーザーがデータエクスポートを要求した時、システムはプレーンテキスト形式のオプションを提供する
3. データをエクスポートする時、システムは関連するすべてのフレームデータと計算パラメータを含む
4. 結果が存在しない場合、システムはエクスポートを防止し、適切なメッセージを表示する

### 要求仕様 6

**ユーザーストーリー：** モバイルユーザーとして、練習セッション中に参照できるよう、スマートフォンでツールがシームレスに動作することを望む。

#### 受け入れ基準

1. モバイルデバイス（320px以上）でアクセスした時、システムは単一列の縦レイアウトを表示する
2. タブレット（768px以上）でアクセスした時、システムは2列レイアウトを表示する
3. デスクトップ（1024px以上）でアクセスした時、システムは3列レイアウトを表示する
4. タッチインターフェースを使用する時、システムは適切なサイズのタッチターゲット（最小44px）を提供する
5. デバイスの向きが変わった場合、システムはそれに応じてレイアウトを調整する

### 要求仕様 7

**ユーザーストーリー：** アクセシビリティが必要なユーザーとして、能力に関係なく効果的にツールを使用できるよう、完全にアクセシブルなツールを望む。

#### 受け入れ基準

1. キーボードのみでナビゲーションする時、システムは完全な機能へのアクセスを提供する
2. スクリーンリーダーを使用する時、システムは適切なARIAラベルと説明を提供する
3. 情報を区別する時、システムは色だけでなく他の方法（アイコン、テキスト、パターン）を使用する
4. テキストを表示する時、システムは十分なコントラスト比を維持する（WCAG AA準拠）
5. フォーカスがプログラム的に移動される場合、システムはフォーカスの可視性を保証する

### 要求仕様 8

**ユーザーストーリー：** ユーザーとして、複数のシナリオを効率的に分析できるよう、ツールが素早く読み込まれ、応答することを望む。

#### 受け入れ基準

1. アプリケーションが最初に読み込まれる時、システムは3秒以内に読み込みを完了する
2. 計算を実行する時、システムは100ミリ秒以内に結果を返す
3. キャラクターや技を切り替える時、システムは200ミリ秒以内に応答する
4. ネットワーク条件が悪い場合、システムはキャッシュされたデータで機能する
5. 大きなデータセットを読み込む時、システムは読み込みインジケータを提供する

### 要求仕様 9

**ユーザーストーリー：** データを意識するユーザーとして、特定のシナリオに合わせて結果をカスタマイズできるよう、計算パラメータを設定したい。

#### 受け入れ基準

1. ワンパターン相殺が切り替えられた時、システムは調整されたシールド硬直差値で結果を再計算する
2. 距離フィルタリングが適用された時、システムは選択された距離カテゴリ内の技のみを表示する
3. ガードキャンセル行動が切り替えられた時、システムは計算からこれらの行動を含める、または除外する
4. カスタムパラメータが設定された場合、システムはセッション中これらの設定を記憶する
5. パラメータが変更された時、システムは自動的に再計算し、結果を更新する

### 要求仕様 10

**ユーザーストーリー：** 競技プレイヤーとして、分析が現在のゲーム状態を反映するよう、正確で最新のフレームデータにアクセスしたい。

#### 受け入れ基準

1. フレームデータを表示する時、システムはUltimate Frame Dataおよびコミュニティソースから検証されたデータを使用する
2. ゲームアップデートがフレームデータに影響する場合、システムは新しい値で更新可能でなければならない
3. 技の性質を表示する時、システムは発生フレーム、全体フレーム、シールド硬直差、距離情報を含む
4. ソース間でフレームデータの矛盾がある場合、システムは最新の検証済みデータを優先する
5. データの正確性が不確実な場合、システムはこれをユーザーに示す